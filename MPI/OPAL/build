#!/usr/bin/env modbuild

SOURCE_URL="http://amas.web.psi.ch/Downloads/$P/src/$P-$V.tar.bz2"

config_args=()

case ${OS} in
Darwin )
	:
	;;
Linux )
	if (( V_MAJOR < 2)); then
		config_args+=( '-DENABLE_DKS=ON' )
	fi
	;;
esac

# add -fopenmp to CC and CXX, if you want to compile with OpenMP
pbuild::configure() {
	cmake \
		-DCMAKE_INSTALL_PREFIX="${PREFIX}" \
		-DCMAKE_BUILD_TYPE=Release \
		-DENABLE_SAAMG_SOLVER=TRUE \
		"${config_args[@]}" \
		"${MODULE_SRCDIR}"
}

pbuild::add_to_group 'MPI'
pbuild::set_supported_compilers 'gcc/5.4.0' 'gcc/5.5.0' 'gcc/6.4.0' 'gcc/7.3.0'
pbuild::make_all

